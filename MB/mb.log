{"level":"info","message":"[mb:2525] mountebank v1.14.1 now taking orders - point your browser to http://localhost:2525 for help","timestamp":"2020-10-10T02:17:15.487Z"}
{"level":"debug","message":"[mb:2525] config: {\"options\":{\"help\":false,\"noParse\":false,\"nologfile\":false,\"allowInjection\":true,\"localOnly\":false,\"mock\":false,\"debug\":false,\"heroku\":false,\"configfile\":\"ConfigFiles/imposter-pnv.ejs\",\"loglevel\":\"debug\",\"port\":2525,\"pidfile\":\"mb.pid\",\"logfile\":\"mb.log\",\"ipWhitelist\":[\"*\"]},\"process\":{\"nodeVersion\":\"v10.16.0\",\"architecture\":\"x64\",\"platform\":\"darwin\"}}","timestamp":"2020-10-10T02:17:15.488Z"}
{"level":"warn","message":"[mb:2525] Running with --allowInjection set. See http://localhost:2525/docs/security for security info","timestamp":"2020-10-10T02:17:15.488Z"}
{"level":"info","message":"[mb:2525] PUT /imposters","timestamp":"2020-10-10T02:17:15.523Z"}
{"level":"debug","message":"[mb:2525] ::ffff:127.0.0.1:52241 => {\"imposters\":[{\"name\":\"IBService\",\"port\":31102,\"protocol\":\"http\",\"stubs\":[{\"responses\":[{\"is\":{\"statusCode\":200,\"headers\":{\"HTTP-Response-Code\":200,\"HTTP-Response-Code-Text\":\"OK\",\"Content-Type\":\"application/json\"},\"body\":\"\\\"success\\\"\"}}],\"predicates\":[{\"equals\":{\"method\":\"PUT\",\"path\":\"/IBAU/BANKAWAYWEBAPI/user-profile/v1/update-preference/\"}}]},{\"responses\":[{\"inject\":\"function (request, state, logger) {\\n\\n    var fs = require('fs');\\n    var path = require('path');\\n    var util = require('util');\\n    var response, rspFilename;\\n    var requestBody = util.inspect(request['body'],false, null);\\n    var jsonRequestBody = JSON.parse(request.body);\\n    var crn;\\n    logger.info(\\\"Request\\\"+requestBody);\\n    logger.info(\\\"request.body is:\\\"+ request.body);\\n\\n        crn = jsonRequestBody.crn[0];\\n\\n        rspFilename = \\\"Response_registration.json\\\";\\n        response = \\\"{\\\\n    \\\\\\\"userDetails\\\\\\\": {\\\\n        \\\\\\\"crn\\\\\\\": \\\\\\\"CRNREQUEST\\\\\\\",\\\\n        \\\\\\\"uuid\\\\\\\": \\\\\\\"AF8524E8-FC70-E711-BE60-0022642DB6C2\\\\\\\"\\\\n    }\\\\n}\\\"\\n        response = response.replace(JSON.parse(response).userDetails.crn,crn);\\n\\n        logger.info(\\\"---------Response Sent Successfully--------\\\"+ rspFilename + response);\\n\\n    return {\\n\\n        headers: {\\n    \\n                \\\"HTTP-Response-Code\\\": 200,\\n                \\\"HTTP-Response-Code-Text\\\": \\\"OK\\\",\\n                \\\"Content-Type\\\": \\\"application/json\\\"\\n          },\\n          \\\"statusCode\\\": \\\"200\\\",\\n          body: response\\n        };\\n}\"}],\"predicates\":[{\"equals\":{\"method\":\"POST\",\"path\":\"/IBAU/BANKAWAYWEBAPI/user-profile/v1/registration/\"}}]},{\"responses\":[{\"inject\":\"function (request, state, logger) {\\n\\n    var fs = require('fs');\\n    var path = require('path');\\n    var util = require('util');\\n    var response, rspFilename;\\n    var requestBody = util.inspect(request['body'],false, null);\\n    var jsonRequestBody = JSON.parse(request.body);\\n    var crn;\\n    logger.info(\\\"Request\\\"+requestBody);\\n    logger.info(\\\"request.body is:\\\"+ request.body);\\n\\n       // crn = jsonRequestBody.crn[0];\\n\\n        rspFilename = \\\"Response_registration.json\\\";\\n        response = \\\"{\\\\n                                  \\\\\\\"userDetails\\\\\\\": [\\\\n                                    {\\\\n                                      \\\\\\\"crn\\\\\\\": \\\\\\\"542230326\\\\\\\",\\\\n                                      \\\\\\\"ctmStatus\\\\\\\": null,\\\\n                                      \\\\\\\"uuid\\\\\\\": \\\\\\\"ADD84F97-575A-E811-80D6-00155D211C71\\\\\\\",\\\\n                                      \\\\\\\"registrationStatus\\\\\\\": \\\\\\\"Registered\\\\\\\",\\\\n                                      \\\\\\\"lastLogonDate\\\\\\\": \\\\\\\"2018-09-18T06:55:03.493Z\\\\\\\",\\\\n                                      \\\\\\\"emailAddress\\\\\\\": \\\\\\\"dfg@anz.com\\\\\\\",\\\\n                                      \\\\\\\"profileStatus\\\\\\\": \\\\\\\"Locked\\\\\\\"\\\\n                                    },\\\\n                                    {\\\\n                                      \\\\\\\"crn\\\\\\\": \\\\\\\"549429335\\\\\\\",\\\\n                                      \\\\\\\"ctmStatus\\\\\\\": null,\\\\n                                      \\\\\\\"uuid\\\\\\\": \\\\\\\"E81498F2-2BC3-E611-8DF0-0022642DB6C2\\\\\\\",\\\\n                                      \\\\\\\"registrationStatus\\\\\\\": \\\\\\\"Registered\\\\\\\",\\\\n                                      \\\\\\\"lastLogonDate\\\\\\\": \\\\\\\"2018-09-07T01:18:18.397Z\\\\\\\",\\\\n                                      \\\\\\\"emailAddress\\\\\\\": \\\\\\\"chen@anz.com\\\\\\\",\\\\n                                      \\\\\\\"profileStatus\\\\\\\": null\\\\n                                    },\\\\n                                    {\\\\n                                      \\\\\\\"crn\\\\\\\": \\\\\\\"550155316\\\\\\\",\\\\n                                      \\\\\\\"ctmStatus\\\\\\\": null,\\\\n                                      \\\\\\\"uuid\\\\\\\": \\\\\\\"AED84F97-575A-E811-80D6-00155D211C71\\\\\\\",\\\\n                                      \\\\\\\"registrationStatus\\\\\\\": \\\\\\\"Registered\\\\\\\",\\\\n                                      \\\\\\\"lastLogonDate\\\\\\\": \\\\\\\"2018-09-07T01:18:36.687Z\\\\\\\",\\\\n                                      \\\\\\\"emailAddress\\\\\\\": \\\\\\\"abn@anz.com\\\\\\\",\\\\n                                      \\\\\\\"profileStatus\\\\\\\": null\\\\n                                    },\\\\n                                    {\\\\n                                      \\\\\\\"crn\\\\\\\": \\\\\\\"550155332\\\\\\\",\\\\n                                      \\\\\\\"ctmStatus\\\\\\\": null,\\\\n                                      \\\\\\\"uuid\\\\\\\": \\\\\\\"AFD84F97-575A-E811-80D6-00155D211C71\\\\\\\",\\\\n                                      \\\\\\\"registrationStatus\\\\\\\": \\\\\\\"Registered\\\\\\\",\\\\n                                      \\\\\\\"lastLogonDate\\\\\\\": \\\\\\\"2018-08-13T02:10:50.667Z\\\\\\\",\\\\n                                      \\\\\\\"emailAddress\\\\\\\": \\\\\\\"abc@anz.com\\\\\\\",\\\\n                                      \\\\\\\"profileStatus\\\\\\\": null\\\\n                                    },\\\\n                                    {\\\\n                                      \\\\\\\"crn\\\\\\\": \\\\\\\"560254100634034\\\\\\\",\\\\n                                      \\\\\\\"ctmStatus\\\\\\\": null,\\\\n                                      \\\\\\\"uuid\\\\\\\": \\\\\\\"B0D84F97-575A-E811-80D6-00155D211C71\\\\\\\",\\\\n                                      \\\\\\\"registrationStatus\\\\\\\": \\\\\\\"Registered\\\\\\\",\\\\n                                      \\\\\\\"lastLogonDate\\\\\\\": \\\\\\\"2018-06-18T03:55:35.553Z\\\\\\\",\\\\n                                      \\\\\\\"emailAddress\\\\\\\": \\\\\\\"abc@anz.com\\\\\\\",\\\\n                                      \\\\\\\"profileStatus\\\\\\\": \\\\\\\"Locked\\\\\\\"\\\\n                                    },\\\\n                                    {\\\\n                                      \\\\\\\"crn\\\\\\\": \\\\\\\"4560045003233680\\\\\\\",\\\\n                                      \\\\\\\"ctmStatus\\\\\\\": null,\\\\n                                      \\\\\\\"uuid\\\\\\\": \\\\\\\"B1D84F97-575A-E811-80D6-00155D211C71\\\\\\\",\\\\n                                      \\\\\\\"registrationStatus\\\\\\\": \\\\\\\"Registered\\\\\\\",\\\\n                                      \\\\\\\"lastLogonDate\\\\\\\": \\\\\\\"2018-06-18T04:18:33.827Z\\\\\\\",\\\\n                                      \\\\\\\"emailAddress\\\\\\\": \\\\\\\"abcv@anz.com\\\\\\\",\\\\n                                      \\\\\\\"profileStatus\\\\\\\": \\\\\\\"Suspended\\\\\\\"\\\\n                                    }\\\\n                                  ]\\\\n                                }\\\"\\n       // response = response.replace(JSON.parse(response).userDetails.crn,crn);\\n\\n        logger.info(\\\"---------Response Sent Successfully--------\\\"+ rspFilename + response);\\n\\n    return {\\n\\n        headers: {\\n    \\n                \\\"HTTP-Response-Code\\\": 200,\\n                \\\"HTTP-Response-Code-Text\\\": \\\"OK\\\",\\n                \\\"Content-Type\\\": \\\"application/json\\\"\\n          },\\n          \\\"statusCode\\\": \\\"200\\\",\\n          body: response\\n        };\\n}\"}],\"predicates\":[{\"equals\":{\"method\":\"POST\",\"path\":\"/crns/ib-status\"}}]},{\"responses\":[{\"is\":{\"statusCode\":200,\"headers\":{\"HTTP-Response-Code\":200,\"HTTP-Response-Code-Text\":\"OK\",\"Content-Type\":\"application/json\"},\"body\":\"{\\n  \\\"crn\\\": \\\"550506311\\\",\\n  \\\"anzsiid\\\": \\\"61290009\\\",\\n  \\\"uuid\\\": \\\"6A80986A-E935-E511-813B-0033642DB6C1\\\",\\n  \\\"cmcid\\\": \\\"87654323\\\",\\n  \\\"enabledfor\\\": [\\n      \\\"CMCWEB\\\",\\n      \\\"CMCAPI\\\"\\n  ],\\n  \\\"provisionedfor\\\": [\\n      \\\"CMCWEB\\\",\\n      \\\"CMCAPI\\\"\\n  ],\\n  \\\"usernote\\\": \\\"The User is Valid\\\",\\n  \\\"status\\\": \\\"active\\\"\\n}\"}}],\"predicates\":[{\"equals\":{\"method\":\"POST\",\"path\":\"/identities/share-investing-ids\"}}]},{\"responses\":[{\"inject\":\"function (request, state, logger) {\\n\\n    var fs = require('fs');\\n    var path = require('path');\\n    var util = require('util');\\n    var response,i,j, rspFilename;\\n    var crnvalue = [];\\n    var requestBody = util.inspect(request['body'],false, null);\\n    logger.info(\\\"Request body is \\\"+ request.body);\\n    var jsonRequestBody = JSON.parse(request.body);\\n    var crn;\\n        var crnlength = parseInt(Object.keys(jsonRequestBody.crn).length);\\n        logger.info(\\\"CRNLENGTH is :\\\"+ crnlength);\\n\\n        for (i=0;i<crnlength;i++)\\n        {\\n            crnvalue[i] =jsonRequestBody.crn[i];\\n        }\\n\\nvar JSONPathLookuP = path.join('ConfigFiles','Mappers','IBService','UserProfile','UserProfile.json');\\n\\nvar obj = JSON.parse(fs.readFileSync(JSONPathLookuP));\\n\\nvar LookUpLen = Object.keys(obj.UserProfile).length;\\n\\n\\nfor(i=0;i<LookUpLen;i++)\\n{\\nvar crnlengthexpected = parseInt(obj.UserProfile[i].crnlength);\\n\\nif(crnlength==crnlengthexpected)\\n{\\nrspFilename = obj.UserProfile[i].ResponseFile;\\nlogger.info(rspFilename);\\n\\nvar JSONPath = path.join('ConfigFiles','Templates','IBService','UserProfile', rspFilename);\\nresponse = JSON.parse(fs.readFileSync(JSONPath));\\nlogger.info(\\\"Response is :\\\"+ response);\\n\\nbreak;\\n}\\n\\n}\\nresponse = JSON.stringify(response);\\n\\nfor (i = 0;i<crnlength;i++)\\n{\\n    response = response.replace(JSON.parse(response).userDetails[i].crn, crnvalue[i]);\\n}\\n\\n    logger.info(\\\"---------Response Sent Successfully--------\\\"+ rspFilename + response);\\n\\n    return {\\n\\n        headers: {\\n    \\n                \\\"HTTP-Response-Code\\\": 200,\\n                \\\"HTTP-Response-Code-Text\\\": \\\"OK\\\",\\n                \\\"Content-Type\\\": \\\"application/json\\\"\\n          },\\n          \\\"statusCode\\\": \\\"200\\\",\\n          body: response\\n        };\\n}\"}],\"predicates\":[{\"equals\":{\"method\":\"POST\",\"path\":\"/IBAU/BANKAWAYWEBAPI/users/v1/user-profiles/\"}}]}]},{\"name\":\"Hunter\",\"port\":4577,\"protocol\":\"http\",\"stubs\":[{\"responses\":[{\"is\":{\"statusCode\":200,\"headers\":{\"HTTP-Response-Code\":200,\"HTTP-Response-Code-Text\":\"OK\",\"Content-Type\":\"application/xml\"},\"body\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<soap:Envelope\\n    xmlns:soap=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n    <soap:Body>\\n        <urn:DeviceResponse\\n            xmlns:urn=\\\"urn:mclsoftware.co.uk:hunterII\\\">\\n            <TransactionID>c11ba00e-e49d-40ca-8d1a-bfeee68e28ba</TransactionID>\\n            <ReturnCode>000a0</ReturnCode>\\n            <ReturnDetails>Successful Transaction</ReturnDetails>\\n        </urn:DeviceResponse>\\n    </soap:Body>\\n</soap:Envelope>\"}}],\"predicates\":[{\"equals\":{\"method\":\"POST\",\"path\":\"/Hunter/DeviceProfileDetails/v1\"},\"matches\":{\"body\":\"[^]*\"}}]},{\"responses\":[{\"is\":{\"statusCode\":200,\"headers\":{\"HTTP-Response-Code\":200,\"HTTP-Response-Code-Text\":\"OK\",\"Content-Type\":\"application/xml\"},\"body\":\"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n<soapenv:Envelope xmlns:soapenv=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n    <soapenv:Header/>\\n    <soapenv:Body>\\n        <MatchResponse xmlns=\\\"http://www.mclsoftware.co.uk/HunterII/WebServices\\\">\\n            <MatchResult>\\n                <![CDATA[\\n                    <ResultBlock>\\n                        <MatchSummary matches=\\\"0\\\">\\n                            <TotalMatchScore>160</TotalMatchScore>\\n                            <Rules totalRuleCount=\\\"2\\\">\\n                                <Rule ruleCount=\\\"1\\\">\\n                                    <RuleID>VAL_Inter_Branch_4</RuleID>\\n                                    <Score>60</Score>\\n                                </Rule>\\n                                <Rule ruleCount=\\\"1\\\">\\n                                    <RuleID>TEST_EARLIEST_VERSION_MATCH</RuleID>\\n                                    <Score>100</Score>\\n                                </Rule>\\n                            </Rules>\\n                            <MatchSchemes schemeCount=\\\"2\\\">\\n                                <Scheme>\\n                                    <SchemeID>14</SchemeID>\\n                                    <Score>100</Score>\\n                                </Scheme>\\n                                <Scheme>\\n                                    <SchemeID>19</SchemeID>\\n                                    <Score>60</Score>\\n                                </Scheme>\\n                            </MatchSchemes>\\n                        </MatchSummary>\\n                        <ErrorWarnings>\\n                            <Errors errorCount=\\\"0\\\" />\\n                            <Warnings warningCount=\\\"0\\\" />\\n                        </ErrorWarnings>\\n                    </ResultBlock>\\n                ]]>\\n            </MatchResult>\\n        </MatchResponse>\\n    </soapenv:Body>\\n</soapenv:Envelope>\"}}],\"predicates\":[{\"equals\":{\"method\":\"POST\",\"path\":\"/Hunter/DeviceApplicationDetails/v1\"},\"matches\":{\"body\":\"[^]*\"}}]}]}]}","timestamp":"2020-10-10T02:17:15.623Z"}
{"level":"info","message":"[http:31102 IBService] Open for business...","timestamp":"2020-10-10T02:17:15.639Z"}
{"level":"info","message":"[http:4577 Hunter] Open for business...","timestamp":"2020-10-10T02:17:15.639Z"}
{"level":"info","message":"[mb:2525] Adios - see you soon?","timestamp":"2020-10-10T02:17:19.186Z"}
